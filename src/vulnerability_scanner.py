# ============================================================
# Digital Sentinel - Vulnerability Scanner
# ============================================================

import random

def run_scanner(urls):
    """
    Simulate scanning URLs for vulnerabilities.
    """
    print("[SCAN] Running vulnerability detection routines...")

    findings = []
    vuln_types = ["XSS", "SQLi", "LFI", "Open Redirect", "Sensitive Info"]

    for url in urls:
        # Randomly decide if this URL has a vulnerability
        if random.random() < 0.3:
            vuln = random.choice(vuln_types)
            findings.append({
                "target": url.split("/")[2],
                "category": vuln,
                "url": url,
                "severity": random.choice(["low", "medium", "high"]),
                "description": f"Possible {vuln} vulnerability detected.",
                "poc": f"curl '{url}?test=<script>alert(1)</script>'"
            })

    print(f"[SCAN] {len(findings)} potential vulnerabilities found.")
    return findings

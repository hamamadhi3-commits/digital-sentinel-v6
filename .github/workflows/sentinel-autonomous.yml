name: Digital Sentinel v11 â€“ Eternal Autonomous Mode

on:
  workflow_dispatch:         # Ø¨Û† Ø¯Û•Ø³ØªÙ¾ÛÚ©Ø±Ø¯Ù†ÛŒ Ø¯Û•Ø³ØªÛŒ
  schedule:
    - cron: "*/30 * * * *"   # Ù‡Û•Ù…ÙˆÙˆ 30 Ø®ÙˆÙ„Û•Ú© Ø¬Ø§Ø±ÛÚ© Ø®Û†Ú©Ø§Ø± Ø¯Û•Ø³ØªÙ¾ÛØ¯Û•Ú©Ø§Øª

jobs:
  recon-cycle:
    runs-on: ubuntu-latest
    timeout-minutes: 25

    steps:
      # ğŸ§± 1. Ú†ÛÚ©â€ŒØ¦Ø§ÙˆÙˆØªÛŒ Ø±ÛŒÙ¾Û†
      - name: ğŸ“¦ Checkout Repository
        uses: actions/checkout@v4

      # ğŸ§  2. Ø¯Ø§Ù…Û•Ø²Ø±Ø§Ù†Ø¯Ù†ÛŒ Ù¾Ø§ÛŒØªÛ†Ù†
      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      # ğŸ“¦ 3. Ø¯Ø§Ù…Û•Ø²Ø±Ø§Ù†Ø¯Ù†ÛŒ Ù¾ÛÙˆÛŒØ³ØªÛŒÛ•Ú©Ø§Ù†
      - name: ğŸ“¥ Install Dependencies
        run: |
          python3 -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

      # ğŸ” 4. Ù¾Ø´Ú©Ù†ÛŒÙ†ÛŒ Ø³Ø§Ø®ØªØ§Ø±ÛŒ Ù¾Ú•Û†Ú˜Û•
      - name: ğŸ§© Verify Source Structure
        run: |
          echo "ğŸ” Checking project structure..."
          ls -R src/
          echo "âœ… Structure verified successfully."

      # ğŸš€ 5. Ø¯Û•Ø³ØªÙ¾ÛÚ©Ø±Ø¯Ù†ÛŒ Ú©Û†Ù†ØªÚ•Û†ÚµÛ•Ø±ÛŒ Ø³Û•Ø±Û•Ú©ÛŒ
      - name: ğŸš€ Launch Main Controller
        env:
          PYTHONPATH: ${{ github.workspace }}
        run: |
          echo ">>> Starting main_controller_v11.py"
          python3 src/main_controller_v11.py || echo "âš ï¸ Main Controller exited with non-zero code."

      # ğŸ§  6. Ø¯Û•Ø³ØªÙ¾ÛÚ©Ø±Ø¯Ù†ÛŒ Eternal Hunter (Ù†Û•ÙˆÛ•Ø³ØªØ§Ù†)
      - name: ğŸ§  Launch Sentinel Eternal Hunter
        env:
          PYTHONPATH: ${{ github.workspace }}
        run: |
          echo ">>> Starting sentinel_eternal_hunter.py"
          python3 src/sentinel_eternal_hunter.py || echo "âš ï¸ Eternal Hunter exited with non-zero code."

      # ğŸ”” 7. Ø¨Ù†ÛØ±Ø§Ù†ÛŒ Ú•Ø§Ù¾Û†Ø±ØªÛ•Ú©Ø§Ù† Ø¨Û† Discord
      - name: ğŸ”” Send Discord Summary
        if: always()
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          echo ">>> Sending mission summary to Discord..."
          python3 src/discord_notify.py || echo "âš ï¸ Discord report failed."

      # ğŸ“¡ 8. Ø¦Û•Ù¾ÚµÛ†Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú•Ø§Ù¾Û†Ø±ØªÛ•Ú©Ø§Ù† Ùˆ Ù„Ø§Ú¯Û•Ú©Ø§Ù† Ø¨Û† Artifact
      - name: ğŸ“¡ Upload Logs & Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: sentinel-artifacts
          path: |
            data/logs/
            data/reports/
          retention-days: 5

      # âœ… 9. Ù†ÛŒØ´Ø§Ù†Ø¯Ø§Ù†ÛŒ ØªÛ•ÙˆØ§ÙˆÚ©Ø±Ø¯Ù†ÛŒ Ø³ÛŒÚ©Úµ
      - name: âœ… Complete Sentinel Cycle
        run: |
          echo "ğŸ¯ Sentinel cycle completed successfully at $(date)"

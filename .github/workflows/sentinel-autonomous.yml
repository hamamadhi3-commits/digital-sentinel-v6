name: Digital Sentinel v6.0 â€“ Autonomous Mode

on:
  workflow_dispatch:
  schedule:
    # ğŸ” Ø¦Û•Ù…Û• ÙˆØ§ Ø¯Û•Ú©Ø§Øª Ù‡Û•Ù…ÙˆÙˆ 30 Ø®ÙˆÙ„Û•Ú© Ø¬Ø§Ø±ÛÚ© Ø®Û†ÛŒ Ø¨Û•Ø¯Û•Ø³ØªÛŒ Ú©Ø§Ø± Ø¨Ú©Ø§Øª
    - cron: "*/30 * * * *"

jobs:
  recon-cycle:
    runs-on: ubuntu-latest
    timeout-minutes: 20

    steps:
      # ğŸ§± 1. Ø³Û•ØªÛŒâ€ŒÚ©Ø±Ø¯Ù†ÛŒ Ú˜ÛØ±Ú©Ø§Ø±
      - name: ğŸ“¦ Checkout Repository
        uses: actions/checkout@v4

      # ğŸ§  2. Ø¯Ø§Ù…Û•Ø²Ø±Ø§Ù†Ø¯Ù†ÛŒ Ù¾Ø§ÛŒØªÛ†Ù†
      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      # ğŸ“¦ 3. Ø¯Ø§Ù…Û•Ø²Ø±Ø§Ù†Ø¯Ù†ÛŒ Ù¾ÛÙˆÛŒØ³ØªÛŒÛ•Ú©Ø§Ù†
      - name: ğŸ“¥ Install Dependencies
        run: |
          python3 -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

      # ğŸ” 4. Ù¾Ø´Ú©Ù†ÛŒÙ†ÛŒ Ø³Û•Ø±Ú†Ø§ÙˆÛ•Ú©Ø§Ù†
      - name: ğŸ§© Verify Source Structure
        run: |
          echo "Listing source files..."
          ls -R src/

      # ğŸš€ 5. Ú©Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ù…Û†Ø¯ÛÙ„ Ø³Û•Ø±Û•Ú©ÛŒ (Main Controller)
      - name: ğŸš€ Start Autonomous Controller
        env:
          PYTHONPATH: ${{ github.workspace }}
        run: |
          echo ">>> Launching Main Controller..."
          python3 src/main_controller_v11.py || echo "âš ï¸ Controller exited with non-zero code."

      # ğŸ§  6. Ú©Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Hunter Ø®Û†Ú©Ø§Ø± (Eternal Hunter)
      - name: ğŸ§  Start Eternal Hunter
        env:
          PYTHONPATH: ${{ github.workspace }}
        run: |
          echo ">>> Launching Sentinel Eternal Hunter..."
          python3 src/sentinel_eternal_hunter.py || echo "âš ï¸ Eternal Hunter exited with non-zero code."

      # ğŸ§  7. Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒÚ©Ø±Ø¯Ù† Ø¨Û• Discord Ùˆ Ø¨Ù†ÛØ±Ø§Ù†ÛŒ Ú•Ø§Ù¾Û†Ø±Øª
      - name: ğŸ“¡ Upload Logs & Reports
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: sentinel-logs
          path: |
            data/logs/
            data/reports/

      # âœ… 8. Ù¾Ø§Ø´Ú©Ø§Ø±ÛŒ Ùˆ ØªÛ•ÙˆØ§ÙˆÚ©Ø±Ø¯Ù†
      - name: âœ… Complete job
        run: echo "Cycle completed successfully at $(date)"
